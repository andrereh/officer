<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Replace text anywhere in the document, or at a cursor.
Replace all occurrences of old_value with new_value. This method
uses grepl/gsub for pattern matching; you may
supply arguments as required (and therefore use regex features)
using the optional ... argument.
Note that by default, grepl/gsub will use fixed=FALSE, which means
that old_value and new_value will be interepreted as regular
expressions.
Chunking of text
Note that the behind-the-scenes representation of text in a Word document is
frequently not what you might expect! Sometimes a paragraph of text is broken
up (or "chunked") into several "runs," as a result of style changes, pauses
in text entry, later revisions and edits, etc. If you have not styled the
text, and have entered it in an "all-at-once" fashion, e.g. by pasting it or
by outputing it programmatically into your Word document, then this will
likely not be a problem. If you are working with a manually-edited document,
however, this can lead to unexpected failures to find text.
You can use the officer function docx_show_chunk to
show how the paragraph of text at the current cursor has been chunked into
runs, and what text is in each chunk. This can help troubleshoot unexpected
failures to find text.'><title>Replace text anywhere in the document — body_replace_all_text • officer</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Replace text anywhere in the document — body_replace_all_text"><meta property="og:description" content='Replace text anywhere in the document, or at a cursor.
Replace all occurrences of old_value with new_value. This method
uses grepl/gsub for pattern matching; you may
supply arguments as required (and therefore use regex features)
using the optional ... argument.
Note that by default, grepl/gsub will use fixed=FALSE, which means
that old_value and new_value will be interepreted as regular
expressions.
Chunking of text
Note that the behind-the-scenes representation of text in a Word document is
frequently not what you might expect! Sometimes a paragraph of text is broken
up (or "chunked") into several "runs," as a result of style changes, pauses
in text entry, later revisions and edits, etc. If you have not styled the
text, and have entered it in an "all-at-once" fashion, e.g. by pasting it or
by outputing it programmatically into your Word document, then this will
likely not be a problem. If you are working with a manually-edited document,
however, this can lead to unexpected failures to find text.
You can use the officer function docx_show_chunk to
show how the paragraph of text at the current cursor has been chunked into
runs, and what text is in each chunk. This can help troubleshoot unexpected
failures to find text.'><meta property="og:image" content="https://davidgohel.github.io/officer/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">officer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.6.0.001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://ardata-fr.github.io/officeverse/">User Documentation</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidgohel/officer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Replace text anywhere in the document</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidgohel/officer/blob/HEAD/R/docx_replace.R" class="external-link"><code>R/docx_replace.R</code></a></small>
      <div class="d-none name"><code>body_replace_all_text.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Replace text anywhere in the document, or at a cursor.</p>
<p>Replace all occurrences of old_value with new_value. This method
uses <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></code>/<code><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></code> for pattern matching; you may
supply arguments as required (and therefore use <code><a href="https://rdrr.io/r/base/regex.html" class="external-link">regex</a></code> features)
using the optional <code>...</code> argument.</p>
<p>Note that by default, grepl/gsub will use <code>fixed=FALSE</code>, which means
that <code>old_value</code> and <code>new_value</code> will be interepreted as regular
expressions.</p>
<p><strong>Chunking of text</strong></p>
<p>Note that the behind-the-scenes representation of text in a Word document is
frequently not what you might expect! Sometimes a paragraph of text is broken
up (or "chunked") into several "runs," as a result of style changes, pauses
in text entry, later revisions and edits, etc. If you have not styled the
text, and have entered it in an "all-at-once" fashion, e.g. by pasting it or
by outputing it programmatically into your Word document, then this will
likely not be a problem. If you are working with a manually-edited document,
however, this can lead to unexpected failures to find text.</p>
<p>You can use the officer function <code><a href="docx_show_chunk.html">docx_show_chunk</a></code> to
show how the paragraph of text at the current cursor has been chunked into
runs, and what text is in each chunk. This can help troubleshoot unexpected
failures to find text.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">body_replace_all_text</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">old_value</span>,</span>
<span>  <span class="va">new_value</span>,</span>
<span>  only_at_cursor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">headers_replace_all_text</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">old_value</span>,</span>
<span>  <span class="va">new_value</span>,</span>
<span>  only_at_cursor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">footers_replace_all_text</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">old_value</span>,</span>
<span>  <span class="va">new_value</span>,</span>
<span>  only_at_cursor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a docx device</p></dd>


<dt>old_value</dt>
<dd><p>the value to replace</p></dd>


<dt>new_value</dt>
<dd><p>the value to replace it with</p></dd>


<dt>only_at_cursor</dt>
<dd><p>if <code>TRUE</code>, only search-and-replace at the current
cursor; if <code>FALSE</code> (default), search-and-replace in the entire document
(this can be slow on large documents!)</p></dd>


<dt>warn</dt>
<dd><p>warn if <code>old_value</code> could not be found.</p></dd>


<dt>...</dt>
<dd><p>optional arguments to grepl/gsub (e.g. <code>fixed=TRUE</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="header-replace-all-text">header_replace_all_text<a class="anchor" aria-label="anchor" href="#header-replace-all-text"></a></h2>
    

<p>Replacements will be performed in each header of all sections.</p>

<p>Replacements will be performed in each footer of all sections.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></code>, <code><a href="https://rdrr.io/r/base/regex.html" class="external-link">regex</a></code>, <code><a href="docx_show_chunk.html">docx_show_chunk</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Frank Hangler, <a href="mailto:frank@plotandscatter.com">frank@plotandscatter.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_docx.html">read_docx</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="body_add_par.html">body_add_par</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"Placeholder one"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="body_add_par.html">body_add_par</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"Placeholder two"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show text chunk at cursor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="docx_show_chunk.html">docx_show_chunk</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span>  <span class="co"># Output is 'Placeholder two'</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 text nodes found at this cursor. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   &lt;w:t&gt;: 'Placeholder two'</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple search-and-replace at current cursor, with regex turned off</span></span></span>
<span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu">body_replace_all_text</span><span class="op">(</span><span class="va">doc</span>, old_value <span class="op">=</span> <span class="st">"Placeholder"</span>,</span></span>
<span class="r-in"><span>  new_value <span class="op">=</span> <span class="st">"new"</span>, only_at_cursor <span class="op">=</span> <span class="cn">TRUE</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="docx_show_chunk.html">docx_show_chunk</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span>  <span class="co"># Output is 'new two'</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 text nodes found at this cursor. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   &lt;w:t&gt;: 'new two'</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Do the same, but in the entire document and ignoring case</span></span></span>
<span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu">body_replace_all_text</span><span class="op">(</span><span class="va">doc</span>, old_value <span class="op">=</span> <span class="st">"placeholder"</span>,</span></span>
<span class="r-in"><span>  new_value <span class="op">=</span> <span class="st">"new"</span>, only_at_cursor<span class="op">=</span><span class="cn">FALSE</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="cursor.html">cursor_backward</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="docx_show_chunk.html">docx_show_chunk</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span> <span class="co"># Output is 'new one'</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 text nodes found at this cursor. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   &lt;w:t&gt;: 'new one'</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use regex : replace all words starting with "n" with the word "example"</span></span></span>
<span class="r-in"><span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu">body_replace_all_text</span><span class="op">(</span><span class="va">doc</span>, <span class="st">"\\bn.*?\\b"</span>, <span class="st">"example"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="docx_show_chunk.html">docx_show_chunk</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span> <span class="co"># Output is 'example one'</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 text nodes found at this cursor. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   &lt;w:t&gt;: 'example one'</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>proudly brought to you by <a href="https://www.ardata.fr" class="external-link"><img alt="ardata" src="https://www.ardata.fr/img/ardata-logo.svg" width="70"></a></p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

